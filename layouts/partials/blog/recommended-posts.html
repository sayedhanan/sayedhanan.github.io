{{ $currentPage := .Page }}
{{ $currentCategory := .Param "categories" }}

{{ $relatedPosts := where (where site.Pages "Type" "in" site.Params.mainSections) "Params.categories" "intersect"
$currentCategory }}
{{ $relatedPosts = first 3 $relatedPosts }}

{{ if $relatedPosts }}

<div class="container mx-auto px-4 lg:px-0 max-w-screen-xl">
  <div class="mb-10">
    <h2 class="text-3xl px-8 font-bold mb-4">Recommended Posts</h2>
  </div>
  <div class="flex flex-wrap mt-10 -mx-4">
    {{ range $relatedPosts }}
    <div class="w-full sm:w-1/2 lg:w-1/3 px-4 mb-4">
      {{ partial "blog/blog-card.html" . }}
    </div>
    {{ end }}
  </div>
</div>
{{ end }}